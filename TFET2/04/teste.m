%%
%%%Read data and store it in a struct
op1 = [];
op2 = [];
%%%%%%%%%

aux = 4

if aux == 1 %vbg = inverso com vds 0.5V
addpath C:\Users\becahp\UnB\Artigo\Simulacoes\TFET2\00_ideal\nHP_vds05

end

%preciso dos nomes nHP_BG_inv_25_dd_iv, nHP_BG_inv_25_op
if aux == 1
nomeFile = ['nHP_vds05'];
tamanho = 101;
um = 1;



auxStr = [nomeFile '_op' num2str(um) '_dd_inqu.elpa'];

op2 =  rdcelpa(auxStr,'*',[],op2);	% 0.0
x_min = find(op2(1).x == 6.100000000000000e-08, 1);
x_max = find(op2(1).x == 7.200000000000000E-08, 1);
x_mean = (x_max + x_min)/2;
%vectorPSI = op2(1).psI_demi(x_min:x_max)'; %Electrostatic potential in the channel
psi_zero = op2(1).psI_demi(x_mean)
psi_zero = 0.180139165800000;

qs_zero = op2(1).space_charge(x_mean)
qs_zero = 1.072943641000000e+08;
op2 = [];
end

if aux == 2
map = [0, 0, 1
    0, 0.5, 0
    1, 0, 0
    0, 0.75, 0.75
    0.75, 0, 0.75
    0.25, 0.25, 0.25
	0, 0, 1];
	
	
addpath C:\Users\becahp\UnB\Artigo\Simulacoes\TFET2\02_otimizacao\04_tbox\nLP_tbox_25
addpath C:\Users\becahp\UnB\Artigo\Simulacoes\TFET2\00_ideal\03_rampa\nLP_tbox_25_v2

op2 =  rdcelpa('nLP_tbox_25_dd_iv.elpa','*',[],op2); 	%1.0 0.0 101/
op2 =  rdcelpa('nLP_tbox_25_v2_dd_iv.elpa','*',[],op2);	%0.0 1.0 101/


op2(1).I_d = abs(op2(1).I_d);
op2(1).I_s = abs(op2(1).I_s);
op2(1).I_g = abs(op2(1).I_g);

op2(2).I_d = abs(op2(2).I_d);
op2(2).I_s = abs(op2(2).I_s);
op2(2).I_g = abs(op2(2).I_g);


Vg_FE = [0.707051851104523	0.704006056627463	0.701001072573973	0.698037120659129	0.695113754120166	0.692230365294713	0.689386132424534	0.686579473477909	0.683808741653417	0.681071654409407	0.678365500411952	0.675687015141579	0.673032297889546	0.670396900289542	0.667775606446676	0.665162475756700	0.662550722619233	0.659932705638846	0.657299734095402	0.654641899805473	0.651948044180198	0.649205495209396	0.646399831303072	0.643514655128451	0.640531285725438	0.637428407202692	0.634181744587517	0.630763741946057	0.627143352248834	0.623286002081273	0.619153952281486	0.614707098076803	0.609904678888770	0.604707937138009	0.599083623989568	0.593008201138954	0.586471960466486	0.579481996160220	0.572062981594031	0.564254978547980	0.556108888455716	0.547680542747053	0.539024982630746	0.530192147193338	0.521224568021337	0.512156659024227	0.503015246941654	0.493820639678714	0.484587945864071	0.475328257778360	0.466049618395198	0.456757831745650	0.447457000542129	0.438149982617236	0.428838726018730	0.419524504293204	0.410208157382391	0.400890210657157	0.391571012441399	0.382250790354482	0.372929731919584	0.363607987356778	0.354285673752373	0.344962885331423	0.335639698186089	0.326316176039452	0.316992376123775	0.307668345505566	0.298344124204605	0.289019750030776	0.279695255942877	0.270370673654751	0.261046029680066	0.251721348786385	0.242396655078738	0.233071970122575	0.223747314132452	0.214422705899597	0.205098163220739	0.195773702557170	0.186449339246757	0.177125087654928	0.167800961105066	0.158476972159934	0.149153132141130	0.139829451926978	0.130505941463183	0.121182610279395	0.111859467507742	0.102536522203061	0.0932137831638260	0.0838912597497806	0.0745689613957791	0.0652468980215238	0.0559250800380435	0.0466035187516665	0.0372822257662832	0.0279612135849832	0.0186404956108460	0.00932008594756051	0];

Vg_FE_v2 = [0	0.00932008604769072	0.0186404956112463	0.0279612136857747	0.0372822257676245	0.0466035188538523	0.0559250801415533	0.0652468980267684	0.0745689614028613	0.0838912598583711	0.0932137832734027	0.102536522313159	0.111859467618009	0.121182610389587	0.130505941573145	0.139829452036603	0.149153132250357	0.158476972268740	0.167800961213443	0.177125087762831	0.186449339354232	0.195773702664292	0.205098163327372	0.214422705905837	0.223747314238328	0.233071970228118	0.242396655183904	0.251721348791257	0.261046029684620	0.270370673659029	0.279695256046853	0.289019750134488	0.298344124308072	0.307668345508818	0.316992376226786	0.326316176042249	0.335639698288689	0.344962885333848	0.354285673854610	0.363607987458934	0.372929732021460	0.382250790356241	0.391571012543027	0.400890210758560	0.410208157383749	0.419524504294438	0.428838726019850	0.438149982518079	0.447457000542881	0.456757831746306	0.466049618395674	0.475328257774168	0.484587945863760	0.493820639678907	0.503015246941835	0.512156659024125	0.521224568021348	0.530192147291200	0.539024982926458	0.547680543434788	0.556108888454823	0.564254980594473	0.572062987306612	0.579481999039559	0.586471964168884	0.593008205361017	0.599083624361122	0.604707950531557	0.609904681845773	0.614707101955032	0.619153967615968	0.623286013400458	0.627143365400015	0.630763754247453	0.634181750024060	0.637428411127763	0.640531293415205	0.643514662429532	0.646399831301217	0.649205495445309	0.651948044172685	0.654641899952701	0.657299734093546	0.659932720503577	0.662550725732990	0.665162478560975	0.667775609256608	0.670396900436770	0.673032297887691	0.675687017360835	0.678365503880450	0.681071657098543	0.683808744448210	0.686579476278360	0.689386135064587	0.692230367006321	0.695113754118310	0.698037120657273	0.701001072572118	0.704006056625607	0.707051851102668];




if aux == 3
figure
h(1) = semilogy(op2(1).V_g,op2(1).I_d );

xlabel('V_{gs} (V)')
ylabel('I_{ds} (A)')

xlim([0 0.5])
%axis([0 0.8 1E-21 1e-5])
%ay = gca;
%ay.YTick = [1e-12 1e-11 1e-10 1e-9 1e-8 1e-7 1e-6 1e-5];

hold; 
h(2) = semilogy(op2(2).V_g,op2(2).I_d);
h(3) = semilogy(Vg_FE,op2(1).I_d);
h(4) = semilogy(Vg_FE_v2,op2(2).I_d);

h(1).Color = map(1,:);
h(2).Color = map(2,:);
h(3).Color = map(1,:);
h(4).Color = map(2,:);

h(3).LineStyle = '--';
h(4).LineStyle = '--';
legend('TFET', 'NCTFET with FE layer', 'Location', 'best');

end 
figure
h(1) = semilogy(op2(1).V_g,op2(1).I_d );

xlabel('V_{gs} (V)')
ylabel('I_{ds} (A)')

xlim([0 0.5])
hold; 
h(2) = semilogy(op2(1).V_g,op2(1).I_s);
legend('I_d', 'I_s', 'Location', 'best');


figure
h(1) = semilogy(op2(2).V_g,op2(2).I_d );

xlabel('V_{gs} (V)')
ylabel('I_{ds} (A)')

xlim([0 0.5])
hold; 
h(2) = semilogy(op2(2).V_g,op2(2).I_s);
legend('I_d', 'I_s', 'Location', 'best');


for i=1:2
figure
h(1) = semilogy(op2(i).V_g,op2(i).I_d );

xlabel('V_{gs} (V)')
ylabel('I_{ds} (A)')

xlim([0 0.5])
hold; 
h(2) = semilogy(op2(i).V_g,op2(i).I_s);
h(3) = semilogy(op2(i).V_g,op2(i).I_g);

legend('I_d', 'I_s','I_g', 'Location', 'best');
end

end

if aux == 4
addpath C:\Users\becahp\UnB\Artigo\Simulacoes\TFET2\03_backgate\LP %backgate
addpath C:\Users\becahp\UnB\Artigo\Simulacoes\TFET2\02_otimizacao\04_tbox\nHP_tbox_25 %tbox
op2 = [];

op2 =  rdcelpa('LP/nLP_BG_000_dd_iv.elpa','*',[],op2);
op2 =  rdcelpa('nHP_tbox_25/nHP_tbox_25_dd_iv.elpa','*',[],op2);


figure
h(1) = semilogy(op2(1).V_g,op2(1).I_d );

xlabel('V_{gs} (V)')
ylabel('I_{ds} (A)')

%xlim([0 0.5])
hold; 
h(2) = semilogy(op2(1).V_g,op2(1).I_d);
legend('BG', 'FE', 'Location', 'best');



end
