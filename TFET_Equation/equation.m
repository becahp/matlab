clear;
close all;

%%
%%%Read data and store it in a struct
op2 = [];
psi_s = [];
e_x = [];
E_ox = [];
%%%%%%%%%

addpath C:\Users\becahp\UnB\Artigo\Simulacoes\TFET\02_PGD_var\03_spacer_n\nHP_sp_40

%------------------------------------------------------------------------------------------------------------------------------------- VGS, ID

psi_s = [0.653417639104444	0.648257873497778	0.643097291595556	0.637936190986666	0.632774833873333	0.627613448273333	0.622452330648889	0.617291789893333	0.612132146906667	0.606973735437778	0.601816892284444	0.596661960257778	0.591509289531111	0.586359235502222	0.581212158084445	0.576068419577778	0.570928382568889	0.565792408371111	0.560660855375556	0.555534075922222	0.550412414631111	0.545296204646667	0.540185765302222	0.535081397488889	0.529983379997778	0.524891964124445	0.519807365455556	0.514729757542222	0.509659263784444	0.504595948264444	0.499539805906667	0.494490759448889	0.489448652568889	0.484413262384445	0.479384312000000	0.474361485073333	0.469344481335556	0.464333037355556	0.459327056988889	0.454326429004445	0.449331535415556	0.444342524482222	0.439360019871111	0.434384483786667	0.429415935584444	0.424453535882222	0.419494268951111	0.414534553895556	0.409572636404444	0.404606489580000	0.399633378486667	0.394649355882222	0.389648778686667	0.384624155731111	0.379566494342222	0.374466045406667	0.369313252544444	0.364099449262222	0.358817231224445	0.353460562695556	0.348024614064444	0.342505397917778	0.336899301904444	0.331202534522222	0.325410580982222	0.319517685051111	0.313516322562222	0.307396910146667	0.301147240282222	0.294752537797778	0.288195388668889	0.281456061086667	0.274513239428889	0.267345493066667	0.259933435031111	0.252262497588889	0.244325865153333	0.236126716311111	0.227678891228889	0.219005572475556	0.210136357635556	0.201103759266667	0.191940197924444	0.182676175635556	0.173339747764444	0.163957176628889	0.154554471651111	0.145159680573333	0.135805787424445	0.126534034368889	0.117397152586667	0.108461415216889	0.0998057828633333	0.0915163589082222	0.0836760094417778	0.0763517963960000	0.0695850732484444	0.0633879204855556	0.0577462574324445	0.0526268192813333	0.0479850687673333];

e_x = [2003909.38748118	1951692.67415274	1900033.70927398	1848614.23124933	1797448.76451667	1746552.96080689	1695942.79764282	1645769.09892851	1596279.34030467	1547137.16072600	1498361.59858956	1449972.19244398	1402462.70851111	1355537.65054511	1309070.82368533	1263082.95107792	1218325.33037667	1174128.06639644	1130482.96578047	1087952.81592578	1046383.62294089	1005434.53946733	965692.405207556	927106.176238444	889196.177706378	852831.800597111	817562.676679778	783031.454219751	750645.321007334	718988.382953778	688893.933355555	660367.112237778	632802.865132956	607635.662211556	583154.411063578	561355.508124889	540404.291641111	522203.300727333	504978.481040578	491058.603210667	478580.009817556	469161.375083778	463037.467640000	463548.690377556	472716.779307333	492356.972561822	530205.692141111	572203.479046667	616091.738270578	663336.728215334	711301.842710755	762069.640214000	813367.688663778	866110.559772889	919796.693964000	973109.589442511	1028012.57768511	1081717.32045378	1135547.07205600	1188568.78222733	1240561.58043667	1292133.57554422	1342568.77827000	1392773.99997644	1443084.06517000	1493226.57940813	1546012.39362689	1600871.23812111	1659229.68939422	1722737.34444378	1793113.51214056	1872066.23777209	1961162.12504158	2061626.91347031	2174098.54858617	2298709.68784762	2434149.65885889	2578045.66575756	2727387.75946256	2880362.74115667	3032779.28241956	3182186.90684918	3327902.75369244	3467665.90349822	3600504.69543333	3725764.21709422	3842736.04862200	3950411.49415000	4047220.66907467	4130782.12498933	4197728.39993467	4243736.26529600	4263940.36395445	4253852.22921733	4210639.70898111	4134274.27032489	4027938.99511111	3897468.72443911	3750140.58875267	3593403.05580444	3433948.67759844];

%pegar VGS
op2 =  rdcelpa('nHP_sp_40_dd_iv.elpa','*',[],op2);

%-------------------------------------------------------------------------------------------------------------------------------------
%plot Vgs vs Psi_s, depois plotar Id(Vgs(Psi)
aux = 0;
if aux == 1
figure
h(1) = plot(op2(1).V_g,psi_s);
xlabel('V_g (V)')
ylabel('\Psi_{channel} (V)')

figure
h(1) = plot(op2(1).I_d,psi_s);
xlabel('I_d (A)')
ylabel('\Psi_{channel} (V)')

h(1) = semilogy(psi_s,op2(1).I_d);
end

%-------------------------------------------------------------------------------------------------------------------------------------
eps_cnt = 5;
eps_0 = 8.85E-12; %F/m
alpha = -2.12E8; %m/F

for k = 1:101
  E_ox(k) = (eps_cnt * e_x(k) + psi_s(k)) / ((1/ (2*alpha)) + eps_0);
  Vg_new(k) = E_ox(k) * tox + 
end
